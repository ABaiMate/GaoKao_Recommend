import{Q as S}from"./QueryContainer-778ca57d.js";import{Q as R}from"./QuerySearchCard-abfe6caa.js";import{Q as A}from"./QueryPagination-33101695.js";import{T as E}from"./TableContainer-6b49de73.js";import{T as N}from"./TableToolbar-630e4f38.js";import{Q as C}from"./QueryInput-b0beacee.js";import{U as P}from"./UserItem-db9f1dba.js";import{u as L,F as I,a as V}from"./useValid-d1447d9b.js";import{B as O}from"./BaseDialog-82865103.js";import{D as f,a as $,u as j}from"./useDialog-abda8b4e.js";import{u as F,a as z}from"./useRequest-4cb19bee.js";import{u as T}from"./useNotify-cedc1ad3.js";import{u as M}from"./useFormRules-cbf82972.js";import{F as b}from"./FeedbackApi-dd3975b5.js";import{d as w,r as g,f as Q,g as U,o as k,h as G,i as n,j as a,u as q,m as B,B as H,b as D,F as J,s as K,x as W,y as X,l as o,t as p}from"./index-d31968a7.js";import{u as Y}from"./usePage-8ca7a06e.js";import"./avatar-dc521f05.js";import"./UserApi-7044f7f4.js";import"./useTimes-c127d28f.js";const Z=w({__name:"FeedbackDialog",props:{type:{},id:{}},setup(c){const d=c,_=F(),m=L(),v=T(),{formRules:l,validNull:u}=M();let s=g({});Q(()=>{f.EDIT===d.type&&x()});async function x(){s.value=await _.run(b.getById(d.id))}async function h(r){await m.submit(),r.start();let t;switch(d.type){case f.ADD:t=b.create(s.value);break;case f.EDIT:t=b.modifyById(d.id,s.value);break;default:return}await _.run(t).finally(r.close),v.success("保存成功"),r.submit(s.value)}return(r,t)=>{const y=U("q-form");return k(),G(O,{class:"feedback-dialog",title:"反馈",type:d.type,onSubmit:h,persistent:""},{default:n(()=>[a(y,{ref:"formRef",class:"form q-col-gutter-y-md"},{default:n(()=>[a(I,null,{default:n(()=>[a(V,{modelValue:s.value.content,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value.content=e),label:"内容",rules:q(l),disable:""},null,8,["modelValue","rules"])]),_:1}),a(I,null,{default:n(()=>[a(V,{modelValue:s.value.feedback,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value.feedback=e),label:"反馈",rules:q(l),type:"textarea"},null,8,["modelValue","rules"])]),_:1})]),_:1},512)]),_:1},8,["type"])}}});const ee=B(Z,[["__scopeId","data-v-9860c464"]]),i=c=>(W("data-v-29dc03cf"),c=c(),X(),c),te={class:"admin-feedback"},ae=i(()=>o("th",{class:"text-left"},"ID",-1)),oe=i(()=>o("th",{class:"text-left"},"创建时间",-1)),le=i(()=>o("th",{class:"text-left"},"更新时间",-1)),se=i(()=>o("th",{class:"text-left"},"用户ID",-1)),ne=i(()=>o("th",{class:"text-left"},"内容",-1)),ue=i(()=>o("th",{class:"text-left"},"反馈",-1)),de=i(()=>o("th",{class:"text-left"},"操作",-1)),re=["textContent"],ie=["textContent"],ce=["textContent"],me=["textContent"],pe=["textContent"],fe={class:"q-gutter-x-sm"},_e=w({__name:"TheAdminFeedback",setup(c){T(),H();const d=F();z();const{toPage:_}=Y();$();let m=g(),v=j(ee),l=g({}),u=g({});Q(()=>{});async function s(){m.value.loading.start(),u.value=await d.run(b.getPage({...l.value,..._(u.value)})).finally(m.value.loading.close)}function x(){v.show(f.ADD).onOk(s)}function h(r){v.show(f.EDIT,{id:r.id}).onOk(s)}return(r,t)=>{const y=U("q-btn");return k(),D("div",te,[a(S,{query:l.value,"onUpdate:query":t[4]||(t[4]=e=>l.value=e),page:u.value,"onUpdate:page":t[5]||(t[5]=e=>u.value=e),onSearch:s},{default:n(()=>[a(R,{ref_key:"querySearchRef",ref:m},{default:n(()=>[a(C,{modelValue:l.value.userId,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value.userId=e),label:"用户ID"},null,8,["modelValue"]),a(C,{modelValue:l.value.content,"onUpdate:modelValue":t[1]||(t[1]=e=>l.value.content=e),label:"内容"},null,8,["modelValue"]),a(C,{modelValue:l.value.feedback,"onUpdate:modelValue":t[2]||(t[2]=e=>l.value.feedback=e),label:"反馈"},null,8,["modelValue"])]),_:1},512),a(N,null,{default:n(()=>[a(y,{label:"新增反馈",icon:"add",flat:"",onClick:x})]),_:1}),a(E,null,{header:n(()=>[ae,oe,le,se,ne,ue,de]),body:n(()=>[(k(!0),D(J,null,K(u.value.list??[],e=>(k(),D("tr",{key:e.id},[o("td",{textContent:p(e.id)},null,8,re),o("td",{textContent:p(e.createTime)},null,8,ie),o("td",{textContent:p(e.updateTime)},null,8,ce),o("td",null,[a(P,{"user-id":e.userId},null,8,["user-id"])]),o("td",{textContent:p(e.content)},null,8,me),o("td",{textContent:p(e.feedback?"已反馈":"未反馈")},null,8,pe),o("td",fe,[a(y,{icon:"edit",label:"反馈",color:"blue",size:"sm",flat:"",dense:"",onClick:ve=>h(e)},null,8,["onClick"])])]))),128))]),_:1}),a(A,{page:u.value,"onUpdate:page":t[3]||(t[3]=e=>u.value=e)},null,8,["page"])]),_:1},8,["query","page"])])}}});const Ae=B(_e,[["__scopeId","data-v-29dc03cf"]]);export{Ae as default};
