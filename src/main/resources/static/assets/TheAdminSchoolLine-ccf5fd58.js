import{S as q}from"./SchoolApi-997a0d35.js";import{Q as H}from"./QueryContainer-778ca57d.js";import{Q as J}from"./QuerySearchCard-abfe6caa.js";import{Q as Y}from"./QueryPagination-33101695.js";import{Q as K}from"./QuerySelectRemote-9681b92c.js";import{T as W}from"./TableContainer-6b49de73.js";import{T as X}from"./TableToolbar-630e4f38.js";import{Q as Z}from"./QueryInput-b0beacee.js";import{F as R,Q as A}from"./FormSelect-62b36c15.js";import{u as D,a as j}from"./useRequest-4cb19bee.js";import{d as Q,r as V,c as ee,a as te,G as oe,f as F,g as C,o as S,h as P,i as m,j as n,q as le,M as ae,m as N,u as x,B as ne,b as B,F as se,s as ue,x as re,y as ie,l as s,t as v}from"./index-d31968a7.js";import{a as E}from"./useArray-1b072fc4.js";import{u as de,F as U,a as L}from"./useValid-d1447d9b.js";import{B as ce}from"./BaseDialog-82865103.js";import{D as I,a as me,u as pe}from"./useDialog-abda8b4e.js";import{u as $}from"./useNotify-cedc1ad3.js";import{S as T}from"./SchoolLineApi-27d0a5a5.js";import{u as _e}from"./usePage-8ca7a06e.js";const O=["文科","理科"],M=["本科批","本科提前B","本科一批","专科批","本科二批","本科三批","专科提前批"];function z(_,r,i="name",p="id"){const g=D(),f=j();async function a(y,u){if(u){f.start();const e=await g.run(_(u)).finally(f.close);return E([e],c=>c[i],c=>c[p])}f.start();const o=await g.run(r(y)).finally(f.close)??[];return E(o,e=>e[i],e=>e[p])}return{load:a}}const fe=Q({__name:"FormSelectRemote",props:{modelValue:{},load:{},isNumber:{type:Boolean}},setup(_){const r=_;D();let i=V([]),p=!0,g=ee(()=>r.isNumber&&r.modelValue?Number.parseInt(r.modelValue):r.modelValue);te(()=>r.modelValue,async(o,e)=>{!e&&o&&p&&(i.value=await y("",o),p=!1)}),oe((o,e,c)=>{p=!0,c()}),F(()=>{});async function f(o){p&&(i.value=await y(o),p=!1)}async function a(o,e){if(!o){e(()=>{i.value=[]});return}const c=await y(o);e(()=>i.value=c)}function y(o,e){return r.load(o,e)}async function u(){!r.modelValue||i.value.length}return(o,e)=>{const c=C("q-item-section"),t=C("q-item"),w=C("q-select");return S(),P(w,ae({class:"form-select-remote col","model-value":g.value},o.$attrs,{outlined:"","map-options":"","emit-value":"",dense:"","use-input":"","fill-input":"","hide-selected":"","input-debounce":"300",onInputValue:f,options:i.value,onFilter:a,onFocus:u}),{"no-option":m(()=>[n(t,null,{default:m(()=>[n(c,{class:"text-grey"},{default:m(()=>[le(" 暂无数据，请使用关键字搜索 ")]),_:1})]),_:1})]),_:1},16,["model-value","options"])}}});const ye=N(fe,[["__scopeId","data-v-d489871e"]]),he=Q({__name:"SchoolLineDialog",props:{type:{},id:{}},setup(_){const r=_,i=D(),p=de(),g=$(),{load:f}=z(o=>q.getById(o),o=>q.getList({schoolName:o}),"schoolName");let a=V({});F(()=>{I.EDIT===r.type&&y()});async function y(){a.value=await i.run(T.getById(r.id))}async function u(o){await p.submit(),o.start();let e;switch(r.type){case I.ADD:e=T.create(a.value);break;case I.EDIT:e=T.modifyById(r.id,a.value);break;default:return}await i.run(e).finally(o.close),g.success("保存成功"),o.submit(a.value)}return(o,e)=>{const c=C("q-form");return S(),P(ce,{class:"school-line-dialog",title:"学校分数线",type:r.type,onSubmit:u,persistent:""},{default:m(()=>[n(c,{ref:"formRef",class:"form q-col-gutter-y-md"},{default:m(()=>[n(U,null,{default:m(()=>[n(ye,{modelValue:a.value.schoolId,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.schoolId=t),load:x(f),label:"学校",rules:[t=>!!t||"请输入学校"],"is-number":""},null,8,["modelValue","load","rules"])]),_:1}),n(U,null,{default:m(()=>[n(L,{modelValue:a.value.year,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.year=t),label:"年份",rules:[t=>t&&t.length>0||"请输入年份"]},null,8,["modelValue","rules"]),n(R,{modelValue:a.value.subjectType,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.subjectType=t),label:"科目类型",rules:[t=>t&&t.length>0||"请输入科目类型"],options:x(O)},null,8,["modelValue","rules","options"]),n(R,{modelValue:a.value.batch,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.batch=t),label:"批次",rules:[t=>t&&t.toString().length>0||"请输入批次"],options:x(M)},null,8,["modelValue","rules","options"])]),_:1}),n(U,null,{default:m(()=>[n(L,{modelValue:a.value.score,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.score=t),label:"分数",type:"number",rules:[t=>t&&t.toString().length>0||"请输入分数"]},null,8,["modelValue","rules"]),n(L,{modelValue:a.value.order,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.order=t),label:"位次",type:"number",rules:[t=>t&&t.toString().length>0||"请输入位次"]},null,8,["modelValue","rules"])]),_:1})]),_:1},512)]),_:1},8,["type"])}}});const ve=N(he,[["__scopeId","data-v-b4960bb1"]]),h=_=>(re("data-v-a1db06e2"),_=_(),ie(),_),ge={class:"admin-school-line"},be=h(()=>s("th",{class:"text-left"},"ID",-1)),xe=h(()=>s("th",{class:"text-left"},"创建时间",-1)),Ve=h(()=>s("th",{class:"text-left"},"更新时间",-1)),Ce=h(()=>s("th",{class:"text-left"},"学校ID",-1)),Se=h(()=>s("th",{class:"text-left"},"年份",-1)),Ie=h(()=>s("th",{class:"text-left"},"科目类型",-1)),Te=h(()=>s("th",{class:"text-left"},"批次",-1)),qe=h(()=>s("th",{class:"text-left"},"分数",-1)),De=h(()=>s("th",{class:"text-left"},"位次",-1)),we=h(()=>s("th",{class:"text-left"},"操作",-1)),ke=["textContent"],Be=["textContent"],Ue=["textContent"],Le=["textContent"],Qe=["textContent"],Fe=["textContent"],Ne=["textContent"],Re=["textContent"],Ae=["textContent"],Ee={class:"q-gutter-x-sm"},je=Q({__name:"TheAdminSchoolLine",setup(_){const r=$();ne();const i=D();j();const{toPage:p}=_e(),{showDeleteDialog:g}=me(),{load:f}=z(b=>q.getById(b),b=>q.getList({schoolName:b}),"schoolName");let a=V(),y=pe(ve),u=V({}),o=V({});F(()=>{});async function e(){a.value.loading.start(),o.value=await i.run(T.getPage({...u.value,...p(o.value)})).finally(a.value.loading.close)}function c(){y.show(I.ADD).onOk(e)}function t(b){y.show(I.EDIT,{id:b.id}).onOk(e)}async function w(b){await g()&&(await i.run(T.deleteById(b.id)),r.success("删除成功"),await e())}return(b,d)=>{const k=C("q-btn");return S(),B("div",ge,[n(H,{query:u.value,"onUpdate:query":d[5]||(d[5]=l=>u.value=l),page:o.value,"onUpdate:page":d[6]||(d[6]=l=>o.value=l),onSearch:e},{default:m(()=>[n(J,{ref_key:"querySearchRef",ref:a},{default:m(()=>[n(K,{modelValue:u.value.schoolId,"onUpdate:modelValue":d[0]||(d[0]=l=>u.value.schoolId=l),label:"学校",load:x(f),"is-number":""},null,8,["modelValue","load"]),n(Z,{modelValue:u.value.year,"onUpdate:modelValue":d[1]||(d[1]=l=>u.value.year=l),label:"年份"},null,8,["modelValue"]),n(A,{modelValue:u.value.subjectType,"onUpdate:modelValue":d[2]||(d[2]=l=>u.value.subjectType=l),label:"科目类型",options:x(O)},null,8,["modelValue","options"]),n(A,{modelValue:u.value.batch,"onUpdate:modelValue":d[3]||(d[3]=l=>u.value.batch=l),label:"批次",options:x(M)},null,8,["modelValue","options"])]),_:1},512),n(X,null,{default:m(()=>[n(k,{label:"新增学校分数线",icon:"add",flat:"",onClick:c})]),_:1}),n(W,null,{header:m(()=>[be,xe,Ve,Ce,Se,Ie,Te,qe,De,we]),body:m(()=>[(S(!0),B(se,null,ue(o.value.list??[],l=>(S(),B("tr",{key:l.id},[s("td",{textContent:v(l.id)},null,8,ke),s("td",{textContent:v(l.createTime)},null,8,Be),s("td",{textContent:v(l.updateTime)},null,8,Ue),s("td",{textContent:v(l.schoolId)},null,8,Le),s("td",{textContent:v(l.year)},null,8,Qe),s("td",{textContent:v(l.subjectType)},null,8,Fe),s("td",{textContent:v(l.batch)},null,8,Ne),s("td",{textContent:v(l.score)},null,8,Re),s("td",{textContent:v(l.order)},null,8,Ae),s("td",Ee,[n(k,{icon:"edit",label:"编辑",color:"blue",size:"sm",flat:"",dense:"",onClick:G=>t(l)},null,8,["onClick"]),n(k,{icon:"close",label:"删除",color:"orange",size:"sm",flat:"",dense:"",onClick:G=>w(l)},null,8,["onClick"])])]))),128))]),_:1}),n(Y,{page:o.value,"onUpdate:page":d[4]||(d[4]=l=>o.value=l)},null,8,["page"])]),_:1},8,["query","page"])])}}});const nt=N(je,[["__scopeId","data-v-a1db06e2"]]);export{nt as default};
