import{Q as F}from"./QueryContainer-778ca57d.js";import{Q as G}from"./QuerySearchCard-abfe6caa.js";import{Q as K}from"./QueryPagination-33101695.js";import{T as N}from"./TableContainer-6b49de73.js";import{T as O}from"./TableToolbar-630e4f38.js";import{Q as I}from"./QueryInput-b0beacee.js";import{u as Y,F as S,a as q}from"./useValid-d1447d9b.js";import{B as z}from"./BaseDialog-82865103.js";import{D as x,a as H,u as M}from"./useDialog-abda8b4e.js";import{R as p,H as f,u as U,a as j}from"./useRequest-4cb19bee.js";import{u as Q}from"./useNotify-cedc1ad3.js";import{u as J}from"./useFormRules-cbf82972.js";import{d as A,r as k,f as L,g as R,o as D,h as W,i as c,j as a,u as B,m as P,B as X,b as E,F as Z,s as ee,x as te,y as ae,l as o,t as v}from"./index-d31968a7.js";import{u as oe}from"./usePage-8ca7a06e.js";const h={getById:e=>new p(f.GET,`/setting/${e}`),getListByIds:e=>new p(f.GET,`/setting/list/${e}`),getList:e=>new p(f.GET,"/setting/list",e),getPage:e=>new p(f.GET,"/setting/page",e),create:e=>new p(f.POST,"/setting",e),modifyById:(e,u)=>new p(f.PUT,`/setting/${e}`,u),deleteById:e=>new p(f.DELETE,`/setting/${e}`)},le=A({__name:"SettingDialog",props:{type:{},id:{}},setup(e){const u=e,g=U(),w=Y(),T=Q(),{formRules:m}=J();let l=k({});L(()=>{x.EDIT===u.type&&i()});async function i(){l.value=await g.run(h.getById(u.id))}async function d(r){await w.submit(),r.start();let s;switch(u.type){case x.ADD:s=h.create(l.value);break;case x.EDIT:s=h.modify(u.id,l.value);break;default:return}await g.run(s).finally(r.close),T.success("保存成功"),r.submit(l.value)}return(r,s)=>{const b=R("q-form");return D(),W(z,{class:"setting-dialog",title:"基本配置",type:u.type,onSubmit:d,persistent:""},{default:c(()=>[a(b,{ref:"formRef",class:"form q-col-gutter-y-md"},{default:c(()=>[a(S,null,{default:c(()=>[a(q,{modelValue:l.value.key,"onUpdate:modelValue":s[0]||(s[0]=y=>l.value.key=y),label:"KEY",rules:B(m)},null,8,["modelValue","rules"]),a(q,{modelValue:l.value.value,"onUpdate:modelValue":s[1]||(s[1]=y=>l.value.value=y),label:"VALUE",rules:B(m)},null,8,["modelValue","rules"])]),_:1}),a(S)]),_:1},512)]),_:1},8,["type"])}}});const se=P(le,[["__scopeId","data-v-9022d7d2"]]),_=e=>(te("data-v-4cfc3c24"),e=e(),ae(),e),ne={class:"admin-setting"},ue=_(()=>o("th",{class:"text-left"},"ID",-1)),ie=_(()=>o("th",{class:"text-left"},"创建时间",-1)),de=_(()=>o("th",{class:"text-left"},"更新时间",-1)),re=_(()=>o("th",{class:"text-left"},"KEY",-1)),ce=_(()=>o("th",{class:"text-left"},"VALUE",-1)),pe=_(()=>o("th",{class:"text-left"},"操作",-1)),fe=["textContent"],me=["textContent"],_e=["textContent"],ge=["textContent"],ye=["textContent"],ve={class:"q-gutter-x-sm"},xe=A({__name:"TheAdminSetting",setup(e){const u=Q();X();const g=U();j();const{toPage:w}=oe(),{showDeleteDialog:T}=H();let m=k(),l=M(se),i=k({}),d=k({});L(()=>{});async function r(){m.value.loading.start(),d.value=await g.run(h.getPage({...i.value,...w(d.value)})).finally(m.value.loading.close)}function s(){l.show(x.ADD).onOk(r)}function b(C){l.show(x.EDIT,{id:C.id}).onOk(r)}async function y(C){await T()&&(await g.run(h.deleteById(C.id)),u.success("删除成功"),await r())}return(C,n)=>{const V=R("q-btn");return D(),E("div",ne,[a(F,{query:i.value,"onUpdate:query":n[3]||(n[3]=t=>i.value=t),page:d.value,"onUpdate:page":n[4]||(n[4]=t=>d.value=t),onSearch:r},{default:c(()=>[a(G,{ref_key:"querySearchRef",ref:m},{default:c(()=>[a(I,{modelValue:i.value.key,"onUpdate:modelValue":n[0]||(n[0]=t=>i.value.key=t),label:"KEY"},null,8,["modelValue"]),a(I,{modelValue:i.value.value,"onUpdate:modelValue":n[1]||(n[1]=t=>i.value.value=t),label:"VALUE"},null,8,["modelValue"])]),_:1},512),a(O,null,{default:c(()=>[a(V,{label:"新增基本配置",icon:"add",flat:"",onClick:s})]),_:1}),a(N,null,{header:c(()=>[ue,ie,de,re,ce,pe]),body:c(()=>[(D(!0),E(Z,null,ee(d.value.list??[],t=>(D(),E("tr",{key:t.id},[o("td",{textContent:v(t.id)},null,8,fe),o("td",{textContent:v(t.createTime)},null,8,me),o("td",{textContent:v(t.updateTime)},null,8,_e),o("td",{textContent:v(t.key)},null,8,ge),o("td",{textContent:v(t.value)},null,8,ye),o("td",ve,[a(V,{icon:"edit",label:"编辑",color:"blue",size:"sm",flat:"",dense:"",onClick:$=>b(t)},null,8,["onClick"]),a(V,{icon:"close",label:"删除",color:"orange",size:"sm",flat:"",dense:"",onClick:$=>y(t)},null,8,["onClick"])])]))),128))]),_:1}),a(K,{page:d.value,"onUpdate:page":n[2]||(n[2]=t=>d.value=t)},null,8,["page"])]),_:1},8,["query","page"])])}}});const Qe=P(xe,[["__scopeId","data-v-4cfc3c24"]]);export{Qe as default};
