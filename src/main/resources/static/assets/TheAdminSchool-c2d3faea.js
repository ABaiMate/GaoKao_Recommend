import{Q as j}from"./QueryContainer-778ca57d.js";import{Q as E}from"./QuerySearchCard-abfe6caa.js";import{Q as M}from"./QueryPagination-33101695.js";import{T as P}from"./TableContainer-6b49de73.js";import{T as R}from"./TableToolbar-630e4f38.js";import{Q as w}from"./QueryInput-b0beacee.js";import{F as z}from"./FormEditor-af66954e.js";import{u as L,F as y,a as s}from"./useValid-d1447d9b.js";import{B as Y}from"./BaseDialog-82865103.js";import{d as N,c as O,g as I,o as S,h as F,M as G,m as T,r as h,f as B,i as m,j as t,l as i,B as H,b as k,F as J,s as K,x as W,y as X,t as b}from"./index-d31968a7.js";import{D as x,a as Z,u as ee}from"./useDialog-abda8b4e.js";import{u as Q,a as le}from"./useRequest-4cb19bee.js";import{u as A}from"./useNotify-cedc1ad3.js";import{S as C}from"./SchoolApi-997a0d35.js";import{u as oe}from"./usePage-8ca7a06e.js";const te=N({__name:"FormSelectMultiple",props:{modelValue:{},isString:{type:Boolean},split:{default:","},isSort:{type:Boolean},compareFn:{type:Function,default:(f,r)=>f.localeCompare(r)}},emits:["update:modelValue"],setup(f,{emit:r}){const v=f,_=r;let V=O({get(){const{modelValue:n,isString:l,split:u}=v;return n?l?n.split(u):n:[]},set(n){const{isString:l,split:u,isSort:d,compareFn:p}=v;d&&(n=n.sort(p)),_("update:modelValue",l?n.join(u):n)}});return(n,l)=>{const u=I("q-select");return S(),F(u,G({class:"form-select col",modelValue:V.value,"onUpdate:modelValue":l[0]||(l[0]=d=>V.value=d)},n.$attrs,{outlined:"","map-options":"","emit-value":"",dense:"",multiple:""}),null,16,["modelValue"])}}});const ae=T(te,[["__scopeId","data-v-efb8af43"]]),ne={class:"q-mb-lg q-gutter-x-md"},ue=N({__name:"SchoolDialog",props:{type:{},id:{}},setup(f){const r=f,v=Q(),_=L(),V=A(),n=["211","卓","研","985","双一流","自","双"];let l=h({info:{num:{naNum:"",mdcNum:"",phdNum:"",keySubject:"",studentNum:""},tel:"",tags:[],belong:"",address:"",createYear:"",admissionDetails:"",avgSalary:""},synopsis:""});B(()=>{x.EDIT===r.type&&u()});async function u(){l.value=await v.run(C.getById(r.id)),l.value.synopsis=l.value.synopsis??"",l.value.info=l.value.info??{},l.value.info.tags=l.value.info.tags??[]}async function d(p){await _.submit(),p.start();let o;switch(r.type){case x.ADD:o=C.create(l.value);break;case x.EDIT:o=C.modifyById(r.id,l.value);break;default:return}await v.run(o).finally(p.close),V.success("保存成功"),p.submit(l.value)}return(p,o)=>{const q=I("q-form");return S(),F(Y,{class:"school-dialog",title:"学校",type:r.type,onSubmit:d,persistent:""},{default:m(()=>[t(q,{ref:"formRef",class:"form q-col-gutter-y-md"},{default:m(()=>[t(y,null,{default:m(()=>[t(s,{modelValue:l.value.schoolName,"onUpdate:modelValue":o[0]||(o[0]=e=>l.value.schoolName=e),label:"学校名称",rules:[e=>e&&e.length>0||"请输入学校名称"]},null,8,["modelValue","rules"]),t(s,{modelValue:l.value.province,"onUpdate:modelValue":o[1]||(o[1]=e=>l.value.province=e),label:"省份",rules:[e=>e&&e.length>0||"请输入省份"]},null,8,["modelValue","rules"])]),_:1}),t(y,null,{default:m(()=>[t(s,{modelValue:l.value.info.num.naNum,"onUpdate:modelValue":o[2]||(o[2]=e=>l.value.info.num.naNum=e),label:"院士人数",rules:[e=>e&&e.length>0||"请输入院士人数"]},null,8,["modelValue","rules"]),t(s,{modelValue:l.value.info.num.mdcNum,"onUpdate:modelValue":o[3]||(o[3]=e=>l.value.info.num.mdcNum=e),label:"硕士人数",rules:[e=>e&&e.length>0||"请输入硕士人数"]},null,8,["modelValue","rules"]),t(s,{modelValue:l.value.info.num.phdNum,"onUpdate:modelValue":o[4]||(o[4]=e=>l.value.info.num.phdNum=e),label:"博士人数",rules:[e=>e&&e.length>0||"请输入博士人数"]},null,8,["modelValue","rules"]),t(s,{modelValue:l.value.info.num.keySubject,"onUpdate:modelValue":o[5]||(o[5]=e=>l.value.info.num.keySubject=e),label:"重点学科个数",rules:[e=>e&&e.length>0||"请输入重点学科个数"]},null,8,["modelValue","rules"]),t(s,{modelValue:l.value.info.num.studentNum,"onUpdate:modelValue":o[6]||(o[6]=e=>l.value.info.num.studentNum=e),label:"学生人数",rules:[e=>e&&e.length>0||"请输入学生人数"]},null,8,["modelValue","rules"])]),_:1}),t(y,{class:"q-mb-md"},{default:m(()=>[t(s,{modelValue:l.value.info.tel,"onUpdate:modelValue":o[7]||(o[7]=e=>l.value.info.tel=e),label:"联系电话"},null,8,["modelValue"]),t(s,{modelValue:l.value.info.belong,"onUpdate:modelValue":o[8]||(o[8]=e=>l.value.info.belong=e),label:"所属"},null,8,["modelValue"]),t(s,{modelValue:l.value.info.address,"onUpdate:modelValue":o[9]||(o[9]=e=>l.value.info.address=e),label:"地址"},null,8,["modelValue"]),t(s,{modelValue:l.value.info.createYear,"onUpdate:modelValue":o[10]||(o[10]=e=>l.value.info.createYear=e),label:"创建时间"},null,8,["modelValue"])]),_:1}),t(y,{class:"q-mb-md"},{default:m(()=>[t(s,{modelValue:l.value.info.admissionDetails,"onUpdate:modelValue":o[11]||(o[11]=e=>l.value.info.admissionDetails=e),label:"录取详情"},null,8,["modelValue"]),t(s,{modelValue:l.value.info.avgSalary,"onUpdate:modelValue":o[12]||(o[12]=e=>l.value.info.avgSalary=e),label:"平均就业薪资"},null,8,["modelValue"])]),_:1}),t(y,{class:"q-mb-md"},{default:m(()=>[t(s,{modelValue:l.value.mapUrl,"onUpdate:modelValue":o[13]||(o[13]=e=>l.value.mapUrl=e),label:"全景地图地址"},null,8,["modelValue"])]),_:1}),i("div",ne,[t(ae,{modelValue:l.value.info.tags,"onUpdate:modelValue":o[14]||(o[14]=e=>l.value.info.tags=e),options:n,label:"标签"},null,8,["modelValue"])]),t(z,{modelValue:l.value.synopsis,"onUpdate:modelValue":o[15]||(o[15]=e=>l.value.synopsis=e),label:"简介："},null,8,["modelValue"])]),_:1},512)]),_:1},8,["type"])}}});const se=T(ue,[["__scopeId","data-v-b9dc4bbe"]]),g=f=>(W("data-v-a594c2a5"),f=f(),X(),f),de={class:"admin-school"},ie=g(()=>i("th",{class:"text-left"},"ID",-1)),me=g(()=>i("th",{class:"text-left"},"创建时间",-1)),re=g(()=>i("th",{class:"text-left"},"更新时间",-1)),pe=g(()=>i("th",{class:"text-left"},"学校名称",-1)),fe=g(()=>i("th",{class:"text-left"},"省份",-1)),ce=g(()=>i("th",{class:"text-left"},"操作",-1)),ve=["textContent"],Ve=["textContent"],ge=["textContent"],_e=["textContent"],ye=["textContent"],be={class:"q-gutter-x-sm"},Se=N({__name:"TheAdminSchool",setup(f){const r=A();H();const v=Q();le();const{toPage:_}=oe(),{showDeleteDialog:V}=Z();let n=h(),l=ee(se),u=h({}),d=h({});B(()=>{});async function p(){n.value.loading.start(),d.value=await v.run(C.getPage({...u.value,..._(d.value)})).finally(n.value.loading.close)}function o(){l.show(x.ADD).onOk(p)}function q(D){l.show(x.EDIT,{id:D.id}).onOk(p)}async function e(D){await V()&&(await v.run(C.deleteById(D.id)),r.success("删除成功"),await p())}return(D,c)=>{const U=I("q-btn");return S(),k("div",de,[t(j,{query:u.value,"onUpdate:query":c[3]||(c[3]=a=>u.value=a),page:d.value,"onUpdate:page":c[4]||(c[4]=a=>d.value=a),onSearch:p},{default:m(()=>[t(E,{ref_key:"querySearchRef",ref:n},{default:m(()=>[t(w,{modelValue:u.value.schoolName,"onUpdate:modelValue":c[0]||(c[0]=a=>u.value.schoolName=a),label:"学校名称"},null,8,["modelValue"]),t(w,{modelValue:u.value.province,"onUpdate:modelValue":c[1]||(c[1]=a=>u.value.province=a),label:"省份"},null,8,["modelValue"])]),_:1},512),t(R,null,{default:m(()=>[t(U,{label:"新增学校",icon:"add",flat:"",onClick:o})]),_:1}),t(P,null,{header:m(()=>[ie,me,re,pe,fe,ce]),body:m(()=>[(S(!0),k(J,null,K(d.value.list,a=>(S(),k("tr",{key:a.id},[i("td",{textContent:b(a.id)},null,8,ve),i("td",{textContent:b(a.createTime)},null,8,Ve),i("td",{textContent:b(a.updateTime)},null,8,ge),i("td",{textContent:b(a.schoolName)},null,8,_e),i("td",{textContent:b(a.province)},null,8,ye),i("td",be,[t(U,{label:"查看分数线",color:"green",size:"sm",flat:"",dense:"",to:`/admin/school-line?schoolId=${a.id}`},null,8,["to"]),t(U,{icon:"edit",label:"编辑",color:"blue",size:"sm",flat:"",dense:"",onClick:$=>q(a)},null,8,["onClick"]),t(U,{icon:"close",label:"删除",color:"orange",size:"sm",flat:"",dense:"",onClick:$=>e(a)},null,8,["onClick"])])]))),128))]),_:1}),t(M,{page:d.value,"onUpdate:page":c[2]||(c[2]=a=>d.value=a)},null,8,["page"])]),_:1},8,["query","page"])])}}});const $e=T(Se,[["__scopeId","data-v-a594c2a5"]]);export{$e as default};
