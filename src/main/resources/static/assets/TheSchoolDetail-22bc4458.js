import{T as L}from"./TitleSeparator-7c98d06d.js";import{U as Y}from"./UserComment-3b891e0d.js";import{u as F}from"./useArray-1b072fc4.js";import{d as V,c as R,f as D,g as i,o as n,h as k,i as u,l as t,b as c,s as B,F as j,t as y,q as T,n as J,m as E,B as H,r as g,j as o,Q as K,x as W,y as X,z as G,A as Z,G as ee,k as $}from"./index-d31968a7.js";import{u as z}from"./useNotify-cedc1ad3.js";import{u as N,R as M,H as C,a as A}from"./useRequest-4cb19bee.js";import{S as te}from"./SchoolApi-997a0d35.js";import{D as O,C as oe}from"./Chart-0c5350db.js";import{S as U}from"./SchoolLineApi-27d0a5a5.js";import"./UserAvatar-c28f9a89.js";import"./avatar-dc521f05.js";import"./UserCommentApi-5c7fae53.js";import"./QueryPagination-33101695.js";import"./usePage-8ca7a06e.js";import"./useLoginInfo-0c571403.js";import"./LoginApi-1dda4bc2.js";const ae={class:"text-right text-grey-8"},le=["textContent"],se=["textContent"],ne=V({__name:"TableInfo",props:{info:{},col:{default:1},isMap:{type:Boolean},bordered:{type:Boolean},separator:{default:"none"},dense:{type:Boolean},warp:{type:Boolean}},setup(a){const r=a;let x=R(()=>{let l=[];if(r.isMap)for(let[d,e]of Object.entries(r.info))l.push({label:d,value:e});else l=r.info;return F(l,r.col)});return D(()=>{}),(l,d)=>{const e=i("q-markup-table");return n(),k(e,{class:"table-info",flat:"",separator:l.separator,bordered:l.bordered,dense:l.dense},{default:u(()=>[t("tbody",null,[(n(!0),c(j,null,B(x.value,(q,_)=>(n(),c("tr",{key:_},[(n(!0),c(j,null,B(q,s=>(n(),c(j,null,[t("td",ae,[t("span",{textContent:y(s.label)},null,8,le),T("：")]),t("td",{style:J(l.warp?"white-space: normal":""),textContent:y(s.value)},null,12,se)],64))),256))]))),128))])]),_:1},8,["separator","bordered","dense"])}}});const re=E(ne,[["__scopeId","data-v-44302b15"]]),ue=a=>(W("data-v-8cf67a3b"),a=a(),X(),a),ce={class:"row q-col-gutter-md"},ie={class:"col"},de={class:"row justify-between"},_e=ue(()=>t("thead",null,[t("tr",null,[t("th",{class:"text-left"},"年份"),t("th",{class:"text-left"},"科目类型"),t("th",{class:"text-left"},"批次"),t("th",{class:"text-left"},"分数"),t("th",{class:"text-left"},"位次")])],-1)),pe=["textContent"],me=["textContent"],ve=["textContent"],he=["textContent"],fe=["textContent"],be={class:"col"},ye=V({__name:"SchoolDetailLine",props:{schoolId:{}},setup(a){const r=N(),x=H(),l=a;let d=g([]),e=g("文科"),q=g("SCORE"),_=g({}),s=g({}),S=R(()=>d.value.filter(f=>f.subjectType===e.value));D(()=>{p(),I()});async function p(){_.value=await r.run(O.getLine("SCORE",l.schoolId)),s.value=await r.run(O.getLine("ORDER",l.schoolId))}async function I(){d.value=await r.run(U.getList({schoolId:l.schoolId}))}async function m(){const f=x.dialog({message:"灰色预测中，请稍后",progress:{spinner:K,color:"amber"},persistent:!0,ok:!1}),b=await r.run(U.getGm(l.schoolId,e.value));let v=0;const w=setInterval(()=>{v=Math.min(100,v+Math.floor(Math.random()*22)),f.update({message:`灰色预测中，请稍后 ${v}%`}),v===100&&(clearInterval(w),f.update({title:"预测成功!",message:"预计分数: "+b+"分",progress:!1,ok:!0}))},500)}return(f,b)=>{const v=i("q-btn-toggle"),w=i("q-btn"),P=i("q-markup-table"),Q=i("q-card");return n(),c("div",ce,[t("div",ie,[t("div",de,[o(v,{modelValue:e.value,"onUpdate:modelValue":b[0]||(b[0]=h=>e.value=h),options:[{label:"文科",value:"文科"},{label:"理科",value:"理科"}],size:"sm",unelevated:""},null,8,["modelValue"]),o(w,{unelevated:"",color:"orange",size:"sm",onClick:m},{default:u(()=>[T("灰色预测明年分数")]),_:1})]),o(P,{class:"no-shadow"},{default:u(()=>[_e,t("tbody",null,[(n(!0),c(j,null,B(S.value,h=>(n(),c("tr",{key:h.id},[t("td",{textContent:y(h.year)},null,8,pe),t("td",{textContent:y(h.subjectType)},null,8,me),t("td",{textContent:y(h.batch)},null,8,ve),t("td",{textContent:y(h.score)},null,8,he),t("td",{textContent:y(h.order)},null,8,fe)]))),128))])]),_:1})]),t("div",be,[o(v,{modelValue:q.value,"onUpdate:modelValue":b[1]||(b[1]=h=>q.value=h),options:[{label:"分数图表",value:"SCORE"},{label:"位次图表",value:"ORDER"}],size:"sm",unelevated:""},null,8,["modelValue"]),o(Q,{class:"no-shadow"},{default:u(()=>[o(oe,{type:"line",data:q.value==="SCORE"?_.value:s.value},null,8,["data"])]),_:1})])])}}});const ge=E(ye,[["__scopeId","data-v-8cf67a3b"]]),xe={getById:a=>new M(C.GET,`/school-major/${a}`),getListBySchoolIdYear:(a,r)=>new M(C.GET,`/school-major/school-id/year/${a}/${r}`),getListByIds:a=>new M(C.GET,`/school-major/list/${a}`),getList:a=>new M(C.GET,"/school-major/list",a),getPage:a=>new M(C.GET,"/school-major/page",a),create:a=>new M(C.POST,"/school-major",a),modifyById:(a,r)=>new M(C.PUT,`/school-major/${a}`,r),deleteById:a=>new M(C.DELETE,`/school-major/${a}`)},qe={class:"SchoolMajor relative-position"},Me=["innerHTML"],Ce=["innerHTML"],je=["innerHTML"],Se=["innerHTML"],Te=V({__name:"SchoolMajor",props:{schoolId:{}},setup(a){const r=a;z(),H();const x=N();A(),G();let l=g("focusMajor"),d=g([]);D(()=>{e()});async function e(){d.value=await x.run(xe.getListBySchoolIdYear(r.schoolId,"2018"))}return(q,_)=>{const s=i("q-tab"),S=i("q-tabs"),p=i("q-tab-panel"),I=i("q-tab-panels");return n(),c("div",qe,[o(S,{modelValue:l.value,"onUpdate:modelValue":_[0]||(_[0]=m=>l.value=m),"active-color":"blue",stretch:""},{default:u(()=>[o(s,{label:"重点学科",name:"focusMajor"}),o(s,{label:"特色学科",name:"specialMajor"}),o(s,{label:"国家重点实验室",name:"labMajor"}),o(s,{label:"一流学科",name:"courseMajor"})]),_:1},8,["modelValue"]),(n(!0),c(j,null,B(d.value,m=>(n(),k(I,{modelValue:l.value,"onUpdate:modelValue":_[1]||(_[1]=f=>l.value=f)},{default:u(()=>[o(p,{name:"focusMajor"},{default:u(()=>[t("div",{innerHTML:m.focusMajor},null,8,Me)]),_:2},1024),o(p,{name:"specialMajor"},{default:u(()=>[t("div",{innerHTML:m.specialMajor},null,8,Ce)]),_:2},1024),o(p,{name:"labMajor"},{default:u(()=>[t("div",{innerHTML:m.labMajor},null,8,je)]),_:2},1024),o(p,{name:"courseMajor"},{default:u(()=>[t("div",{innerHTML:m.courseMajor},null,8,Se)]),_:2},1024)]),_:2},1032,["modelValue"]))),256))])}}});const Ie=E(Te,[["__scopeId","data-v-810a4e05"]]),we={class:"school-detail bg-grey-1 q-px-md"},Le={key:0,class:"q-mt-lg"},$e={class:"row items-center"},ke={class:"col-8 text-h5 text-bold"},Be=["textContent"],Ve={class:"col text-right"},De=["src"],Ee=["innerHTML"],Re=V({__name:"TheSchoolDetail",setup(a){z(),H();const r=N(),x=A();G();const l=Z();let d=g(parseInt(l.params.id)),e=g({}),q=R(()=>{var S;if(!((S=e.value)!=null&&S.info))return[];const{info:{num:s}}=e.value;return[{label:"院士人数",value:s.naNum},{label:"硕士人数",value:s.mdcNum},{label:"博士人数",value:s.phdNum},{label:"重点学科个数",value:s.keySubject},{label:"学生人数",value:s.studentNum},{label:"联系电话",value:e.value.info.tel},{label:"所属",value:e.value.info.belong},{label:"地址",value:e.value.info.address},{label:"创建时间",value:e.value.info.createYear},{label:"录取详情",value:e.value.info.admissionDetails},{label:"平均就业薪资",value:e.value.info.avgSalary}]});D(async()=>{await _()}),ee(s=>{d.value=parseInt(s.params.id),_()});async function _(){x.start(),e.value=await r.run(te.getById(d.value)).finally(x.close)??{}}return(s,S)=>{var b,v;const p=i("q-breadcrumbs-el"),I=i("q-breadcrumbs"),m=i("q-chip"),f=i("q-separator");return n(),c("div",we,[o(I,{class:"text-grey q-my-md","active-color":"orange"},{default:u(()=>[o(p,{label:"首页",icon:"home",to:"/"}),o(p,{label:"找高校",to:"/school"}),o(p,{label:e.value.schoolName},null,8,["label"])]),_:1}),e.value.id?(n(),c("div",Le,[t("div",$e,[t("p",ke,[t("span",{textContent:y(e.value.schoolName)},null,8,Be)]),t("div",Ve,[(n(!0),c(j,null,B(((b=e.value.info)==null?void 0:b.tags)??[],w=>(n(),k(m,{textContent:y(w),size:"sm"},null,8,["textContent"]))),256))])]),o(f,{class:"q-mb-lg"}),e.value.mapUrl?(n(),c(j,{key:0},[o(L,null,{default:u(()=>[T("全景地图")]),_:1}),t("iframe",{src:e.value.mapUrl,width:"100%",height:"600px",style:{width:"100%",height:"600px",border:"none"}},null,8,De)],64)):$("",!0),o(L,null,{default:u(()=>[T("院校报告")]),_:1}),o(re,{class:"q-my-lg",info:q.value,col:3},null,8,["info"]),o(L,null,{default:u(()=>[T("往年分数")]),_:1}),o(ge,{class:"q-my-lg","school-id":d.value},null,8,["school-id"]),e.value.synopsis?(n(),c(j,{key:1},[o(L,null,{default:u(()=>[T("学校简介")]),_:1}),t("div",{class:"q-py-md q-pa-xl",innerHTML:(v=e.value.synopsis)==null?void 0:v.trim()},null,8,Ee)],64)):$("",!0),o(L,null,{default:u(()=>[T("相关专业")]),_:1}),e.value.id?(n(),k(Ie,{key:2,"school-id":e.value.id},null,8,["school-id"])):$("",!0)])):$("",!0),e.value.id?(n(),k(Y,{key:1,"target-type":"SCHOOL","target-id":e.value.id},null,8,["target-id"])):$("",!0)])}}});const et=E(Re,[["__scopeId","data-v-fd5a91df"]]);export{et as default};
