import{Q as O}from"./QueryContainer-778ca57d.js";import{Q as j}from"./QuerySearchCard-abfe6caa.js";import{Q as M}from"./QueryPagination-33101695.js";import{T as G}from"./TableContainer-6b49de73.js";import{T as H}from"./TableToolbar-630e4f38.js";import{Q as $}from"./QueryInput-b0beacee.js";import{F as J}from"./FormEditor-af66954e.js";import{u as K,F as S,a as B}from"./useValid-d1447d9b.js";import{d as P,c as W,f as F,g as V,o as c,b as k,t as v,k as L,j as l,i as d,h as w,l as s,q as X,F as A,s as N,C as Y,m as Q,r as U,u as C,B as Z,x as ee,y as te}from"./index-d31968a7.js";import{B as le}from"./BaseDialog-82865103.js";import{D as T,a as oe,u as ae}from"./useDialog-abda8b4e.js";import{u as E,a as ne}from"./useRequest-4cb19bee.js";import{u as z}from"./useNotify-cedc1ad3.js";import{u as se}from"./useFormRules-cbf82972.js";import{P as I}from"./ProfessionApi-32b74b1a.js";import{u as ue}from"./usePage-8ca7a06e.js";const ie={class:"col row items-center"},de=["textContent"],re=["textContent"],me=["textContent"],ce={class:"text-grey-8 q-gutter-xs"},pe=P({__name:"FormList",props:{modelValue:{},showTitle:{type:Boolean},label:{default:"其他信息"},defaultValue:{default:""},noLabel:{type:Boolean}},emits:["update:modelValue"],setup(y,{emit:_}){const u=y,q=_;let i=W({get(){return u.modelValue?{lines:u.modelValue}:{lines:[]}},set(e){const a=e.lines;q("update:modelValue",a)}});F(()=>{});function r(e){const a=i.value.lines;a.splice(e+1,0,u.defaultValue),i.value={lines:a}}function x(e){const a=i.value.lines;a.splice(e,1),i.value={lines:a}}return(e,a)=>{const g=V("q-item-label"),p=V("q-btn"),o=V("q-item"),h=V("q-input"),n=V("q-item-section"),m=V("q-list");return c(),k("div",ie,[u.noLabel?L("",!0):(c(),k("p",{key:0,class:"col-1",textContent:v(u.label)},null,8,de)),l(m,{class:"form-list col",dense:""},{default:d(()=>[u.showTitle?(c(),w(g,{key:0,header:""},{default:d(()=>[s("span",{textContent:v(u.label)},null,8,re)]),_:1})):L("",!0),i.value.lines.length?(c(!0),k(A,{key:2},N(i.value.lines,(D,t)=>(c(),w(o,{key:t},{default:d(()=>[l(n,null,{default:d(()=>[e.$slots.default?Y(e.$slots,"default",{key:0,index:t,value:i.value.lines[t],setValue:f=>i.value.lines[t]=f,addValue:f=>{r(t),i.value.lines[t+1]=f},label:u.label+" "+(t+1)},void 0,!0):(c(),w(h,{key:1,modelValue:i.value.lines[t],"onUpdate:modelValue":f=>i.value.lines[t]=f,label:u.label+" "+(t+1),dense:"",debounce:"500",outlined:""},null,8,["modelValue","onUpdate:modelValue","label"]))]),_:2},1024),l(n,{side:""},{default:d(()=>[s("div",ce,[l(p,{icon:"add",size:"xs",flat:"",round:"",onClick:f=>r(t)},null,8,["onClick"]),l(p,{icon:"remove",size:"xs",flat:"",round:"",onClick:f=>x(t)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128)):(c(),w(o,{key:1,class:"text-center"},{default:d(()=>[l(p,{class:"full-width",color:"primary",flat:"",onClick:a[0]||(a[0]=D=>r(0))},{default:d(()=>[X("添加"),s("span",{textContent:v(u.label)},null,8,me)]),_:1})]),_:1}))]),_:3})])}}});const R=Q(pe,[["__scopeId","data-v-270321c7"]]),_e=P({__name:"ProfessionDialog",props:{type:{},id:{}},setup(y){const _=y,u=E(),q=K(),i=z(),{formRules:r,validNull:x}=se();let e=U({});F(()=>{T.EDIT===_.type&&a()});async function a(){e.value=await u.run(I.getById(_.id))}async function g(p){await q.submit(),p.start();let o;switch(_.type){case T.ADD:o=I.create(e.value);break;case T.EDIT:o=I.modifyById(_.id,e.value);break;default:return}await u.run(o).finally(p.close),i.success("保存成功"),p.submit(e.value)}return(p,o)=>{const h=V("q-form");return c(),w(le,{class:"profession-dialog",title:"职业",type:_.type,onSubmit:g,persistent:""},{default:d(()=>[l(h,{ref:"formRef",class:"form q-col-gutter-y-md"},{default:d(()=>[l(S,null,{default:d(()=>[l(B,{modelValue:e.value.name,"onUpdate:modelValue":o[0]||(o[0]=n=>e.value.name=n),label:"名称",rules:C(r)},null,8,["modelValue","rules"]),l(B,{modelValue:e.value.tag,"onUpdate:modelValue":o[1]||(o[1]=n=>e.value.tag=n),label:"标签",rules:C(r)},null,8,["modelValue","rules"]),l(B,{modelValue:e.value.belong,"onUpdate:modelValue":o[2]||(o[2]=n=>e.value.belong=n),label:"隶属 行业",rules:C(r)},null,8,["modelValue","rules"])]),_:1}),l(R,{modelValue:e.value.related,"onUpdate:modelValue":o[3]||(o[3]=n=>e.value.related=n),label:"相似职业",rules:C(r)},null,8,["modelValue","rules"]),l(R,{modelValue:e.value.counterparts,"onUpdate:modelValue":o[4]||(o[4]=n=>e.value.counterparts=n),label:"相关的专业",rules:C(r)},null,8,["modelValue","rules"]),l(J,{modelValue:e.value.content,"onUpdate:modelValue":o[5]||(o[5]=n=>e.value.content=n),label:"内容",rules:C(r)},null,8,["modelValue","rules"]),l(S)]),_:1},512)]),_:1},8,["type"])}}});const fe=Q(_e,[["__scopeId","data-v-7632ce9d"]]),b=y=>(ee("data-v-ed646f2e"),y=y(),te(),y),ve={class:"admin-profession"},ye=b(()=>s("th",{class:"text-left"},null,-1)),ge=b(()=>s("th",{class:"text-left"},"创建时间",-1)),Ve=b(()=>s("th",{class:"text-left"},"更新时间",-1)),be=b(()=>s("th",{class:"text-left"},"名称",-1)),Ce=b(()=>s("th",{class:"text-left"},"标签",-1)),ke=b(()=>s("th",{class:"text-left"},"隶属行业",-1)),qe=b(()=>s("th",{class:"text-left"},"操作",-1)),xe=["textContent"],he=["textContent"],De=["textContent"],we=["textContent"],Te=["textContent"],Ie=["textContent"],Ue={class:"q-gutter-x-sm"},$e=P({__name:"TheAdminProfession",setup(y){const _=z();Z();const u=E();ne();const{toPage:q}=ue(),{showDeleteDialog:i}=oe();let r=U(),x=ae(fe),e=U({}),a=U({});F(()=>{});async function g(){r.value.loading.start(),a.value=await u.run(I.getPage({...e.value,...q(a.value)})).finally(r.value.loading.close)}function p(){x.show(T.ADD).onOk(g)}function o(n){x.show(T.EDIT,{id:n.id}).onOk(g)}async function h(n){await i()&&(await u.run(I.deleteById(n.id)),_.success("删除成功"),await g())}return(n,m)=>{const D=V("q-btn");return c(),k("div",ve,[l(O,{query:e.value,"onUpdate:query":m[4]||(m[4]=t=>e.value=t),page:a.value,"onUpdate:page":m[5]||(m[5]=t=>a.value=t),onSearch:g},{default:d(()=>[l(j,{ref_key:"querySearchRef",ref:r},{default:d(()=>[l($,{modelValue:e.value.name,"onUpdate:modelValue":m[0]||(m[0]=t=>e.value.name=t),label:"名称"},null,8,["modelValue"]),l($,{modelValue:e.value.tag,"onUpdate:modelValue":m[1]||(m[1]=t=>e.value.tag=t),label:"标签"},null,8,["modelValue"]),l($,{modelValue:e.value.belong,"onUpdate:modelValue":m[2]||(m[2]=t=>e.value.belong=t),label:"隶属 行业"},null,8,["modelValue"])]),_:1},512),l(H,null,{default:d(()=>[l(D,{label:"新增职业",icon:"add",flat:"",onClick:p})]),_:1}),l(G,null,{header:d(()=>[ye,ge,Ve,be,Ce,ke,qe]),body:d(()=>[(c(!0),k(A,null,N(a.value.list??[],t=>(c(),k("tr",{key:t.id},[s("td",{textContent:v(t.id)},null,8,xe),s("td",{textContent:v(t.createTime)},null,8,he),s("td",{textContent:v(t.updateTime)},null,8,De),s("td",{textContent:v(t.name)},null,8,we),s("td",{textContent:v(t.tag)},null,8,Te),s("td",{textContent:v(t.belong)},null,8,Ie),s("td",Ue,[l(D,{icon:"edit",label:"编辑",color:"blue",size:"sm",flat:"",dense:"",onClick:f=>o(t)},null,8,["onClick"]),l(D,{icon:"close",label:"删除",color:"orange",size:"sm",flat:"",dense:"",onClick:f=>h(t)},null,8,["onClick"])])]))),128))]),_:1}),l(M,{page:a.value,"onUpdate:page":m[3]||(m[3]=t=>a.value=t)},null,8,["page"])]),_:1},8,["query","page"])])}}});const Je=Q($e,[["__scopeId","data-v-ed646f2e"]]);export{Je as default};
